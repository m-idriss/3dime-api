# GitHub Configuration
github.username=${GITHUB_USERNAME:m-idriss}
github.api.url=https://api.github.com
github.token=${GITHUB_TOKEN:}

# Server Configuration
quarkus.http.host=0.0.0.0
%dev.quarkus.http.host=localhost
quarkus.http.port=${PORT:8080}

# Proxy Configuration for Cloud Run
quarkus.http.proxy.proxy-address-forwarding=true

# Session Encryption for Production Stability
# Use a string of at least 16 characters for production
quarkus.http.auth.session.encryption-key=${AUTH_SESSION_ENCRYPTION_KEY:}

# REST Client Configuration
quarkus.rest-client."com.dime.api.feature.github.GitHubClient".url=${github.api.url}
quarkus.rest-client."com.dime.api.feature.github.GitHubClient".scope=jakarta.inject.Singleton

quarkus.rest-client."notion-api".url=https://api.notion.com
quarkus.rest-client."notion-api".scope=jakarta.inject.Singleton

# Notion Configuration
notion.token=${NOTION_TOKEN}
notion.tracking.database-id=${NOTION_TRACKING_DB_ID}
notion.version=2022-02-22
notion.cms.database-id=${NOTION_CMS_DB_ID:}
notion.quota.database-id=${NOTION_QUOTA_DB_ID:}
notion.user-id=${NOTION_USER_ID:}

# Gemini Configuration
gemini.model=${GEMINI_MODEL:}
gemini.base-message=${GEMINI_BASE_MESSAGE:}
gemini.system-prompt=${GEMINI_SYSTEM_PROMPT:}
gemini.api.key=${GEMINI_API_KEY:}

quarkus.rest-client."gemini-api".url=https://generativelanguage.googleapis.com
quarkus.rest-client."gemini-api".scope=jakarta.inject.Singleton

# Error Handling Configuration
quarkus.log.category."com.dime.api.feature.shared.exception".level=DEBUG
%dev.quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n
%prod.quarkus.http.enable-compression=true

# OpenTelemetry
quarkus.otel.enabled=true
quarkus.otel.traces.enabled=true
quarkus.otel.logs.enabled=true

quarkus.otel.exporter.otlp.endpoint=https://otel.googleapis.com:4317
quarkus.otel.exporter.otlp.protocol=grpc

%dev.quarkus.otel.exporter.otlp.endpoint=
%dev.quarkus.otel.logs.enabled=false
%dev.quarkus.otel.traces.enabled=false

quarkus.otel.resource.attributes=gcp.project_id=${GOOGLE_CLOUD_PROJECT:}

# Default (dev/test)
quarkus.log.console.json.enabled=false

# PROD ONLY
%prod.quarkus.log.console.json.enabled=true
%prod.quarkus.log.console.json.pretty-print=false
%prod.quarkus.log.console.json.exception-output-type=formatted
%prod.quarkus.log.console.json.print-details=true
%prod.quarkus.log.console.json.key-overrides.level=severity
%prod.quarkus.log.console.json.key-overrides.timestamp=time

%prod.quarkus.log.console.json.additional-field.service=3dime-api
%prod.quarkus.log.console.json.additional-field.version=1.0.0

# Security Logging for Production Debugging
quarkus.log.category."io.quarkus.security".level=DEBUG
%prod.quarkus.log.category."io.quarkus.vertx.http.runtime.security".level=DEBUG

%test.quarkus.http.test-port=0

# Application Configuration
quarkus.application.name=3dime-api

# Package Configuration
quarkus.package.jar.type=uber-jar

# Jandex Configuration - Index Google Cloud dependencies for reflection
quarkus.index-dependency.google-cloud-core.group-id=com.google.cloud
quarkus.index-dependency.google-cloud-core.artifact-id=google-cloud-core
quarkus.index-dependency.google-cloud-firestore.group-id=com.google.cloud
quarkus.index-dependency.google-cloud-firestore.artifact-id=google-cloud-firestore
quarkus.index-dependency.protobuf-java.group-id=com.google.protobuf
quarkus.index-dependency.protobuf-java.artifact-id=protobuf-java

quarkus.swagger-ui.path=/api-docs
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.deep-linking=false
quarkus.swagger-ui.footer=&#169; 2026. This is a Microservice ${quarkus.application.name} by 3dime. <a href="/logout" style="display: inline-block; padding: 4px 12px; border-radius: 6px; background: #6366f1; color: white; text-decoration: none; font-size: 12px; font-weight: 600; margin-left: 15px; transition: opacity 0.2s;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">Logout</a>
quarkus.swagger-ui.display-request-duration=true
quarkus.swagger-ui.default-models-expand-depth=-1
quarkus.swagger-ui.try-it-out-enabled=true

# OpenAPI Configuration
quarkus.smallrye-openapi.info-title=${quarkus.application.name} with Quarkus
quarkus.smallrye-openapi.info-description=This is a Microservice ${quarkus.application.name} based on the OpenAPI 3.0 specification. Click [here](https://github.com/m-idriss/${quarkus.application.name}). You can load via the `Code > Clone`, enjoy."
quarkus.smallrye-openapi.info-version=1.0
quarkus.smallrye-openapi.info-contact-name=Idriss
quarkus.smallrye-openapi.info-contact-url=https://github.com/m-idriss
quarkus.smallrye-openapi.info-contact-email=contact@3dime.com

# OpenAPI Additional Documentation Groups
quarkus.smallrye-openapi.all.path=/api-schema
quarkus.smallrye-openapi.public.path=/api-schema/public
quarkus.smallrye-openapi.public.scan-profiles=public
quarkus.smallrye-openapi.admin.path=/api-schema/admin
quarkus.smallrye-openapi.admin.scan-profiles=admin

# Swagger UI Multiple Groups Configuration
quarkus.swagger-ui.urls.public=${quarkus.smallrye-openapi.public.path}
quarkus.swagger-ui.urls.admin=${quarkus.smallrye-openapi.admin.path}
quarkus.swagger-ui.urls.all=${quarkus.smallrye-openapi.all.path}
quarkus.swagger-ui.urls-primary-name=public

# Health Configuration
quarkus.smallrye-health.root-path=/health

# CORS Configuration
quarkus.http.cors.enabled=true
quarkus.http.cors.origins=https://www.3dime.com,https://3dime.com,https://www.photocalia.com,https://photocalia.com
quarkus.http.cors.methods=GET,PUT,POST,DELETE,PATCH,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=*
quarkus.http.cors.access-control-max-age=24H
%dev.quarkus.http.cors.origins=*

# Cache Configuration
quarkus.cache.caffeine."github-user-cache".expire-after-write=1H
quarkus.cache.caffeine."github-social-cache".expire-after-write=1H
quarkus.cache.caffeine."github-commits-cache".expire-after-write=1H
quarkus.cache.caffeine."notion-cms-cache".expire-after-write=30M
quarkus.cache.caffeine."statistics-cache".expire-after-write=5M

# Security Configuration
quarkus.http.auth.proactive=true
quarkus.http.auth.form.enabled=true
quarkus.http.auth.form.login-page=/login.html
quarkus.http.auth.form.error-page=/login-error.html
quarkus.http.auth.form.landing-page=/api-docs

quarkus.http.auth.session.cookie.secure=true
quarkus.http.auth.session.cookie.http-only=true
quarkus.http.auth.session.cookie.same-site=lax

quarkus.security.users.embedded.enabled=true
quarkus.security.users.embedded.plain-text=true
quarkus.security.users.embedded.users.admin=${ADMIN_PASSWORD:password}
quarkus.security.users.embedded.roles.admin=admin

# Auth Policy
quarkus.http.auth.policy.admin-policy.roles-allowed=admin

# Permit public API endpoints for frontends
quarkus.http.auth.permission.public-api.paths=/converter/*,/github/*,/notion/*
quarkus.http.auth.permission.public-api.policy=permit

# Permit login components
quarkus.http.auth.permission.public-ui.paths=/login.html,/login-error.html,/j_security_check
quarkus.http.auth.permission.public-ui.policy=permit

# Secure Admin paths (users tools, home redirect, and swagger documentation)
quarkus.http.auth.permission.admin.paths=/users/*,/,/api-docs/*,/api-docs,/api-schema/*
quarkus.http.auth.permission.admin.policy=admin-policy

GOOGLE_CLOUD_PROJECT=quarkus.http.limits.max-body-size=20M